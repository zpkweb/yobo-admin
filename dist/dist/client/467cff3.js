(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{396:function(e,t,n){"use strict";var r=n(4),o=n(163),c=n(64),l=n(16),d=n(34),f=n(164),m=n(108),h=n(81),v=n(23),$=h("splice"),x=v("splice",{ACCESSORS:!0,0:0,1:2}),w=Math.max,_=Math.min;r({target:"Array",proto:!0,forced:!$||!x},{splice:function(e,t){var n,r,h,v,$,x,y=d(this),C=l(y.length),k=o(e,C),O=arguments.length;if(0===O?n=r=0:1===O?(n=0,r=C-k):(n=O-2,r=_(w(c(t),0),C-k)),C+n-r>9007199254740991)throw TypeError("Maximum allowed length exceeded");for(h=f(y,r),v=0;v<r;v++)($=k+v)in y&&m(h,v,y[$]);if(h.length=r,n<r){for(v=k;v<C-r;v++)x=v+n,($=v+r)in y?y[x]=y[$]:delete y[x];for(v=C;v>C-r+n;v--)delete y[v-1]}else if(n>r)for(v=C-r;v>k;v--)x=v+n-1,($=v+r-1)in y?y[x]=y[$]:delete y[x];for(v=0;v<n;v++)y[v+k]=arguments[v+2];return y.length=C-r+n,h}})},408:function(e,t,n){var content=n(426);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(29).default)("a490b06e",content,!0,{sourceMap:!1})},409:function(e,t,n){var content=n(428);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(29).default)("cd6bb1c4",content,!0,{sourceMap:!1})},425:function(e,t,n){"use strict";n(408)},426:function(e,t,n){(t=n(28)(!1)).push([e.i,".el-upload-list--picture-card .el-upload-list__item[data-v-0d60f641]{width:100%}",""]),e.exports=t},427:function(e,t,n){"use strict";n(409)},428:function(e,t,n){(t=n(28)(!1)).push([e.i,".avatar-uploader .el-upload{border:1px dashed #d9d9d9;border-radius:6px;cursor:pointer;position:relative;overflow:hidden}.avatar-uploader .el-upload:hover{border-color:#409eff}.avatar-uploader-icon{font-size:28px;color:#8c939d;width:178px;height:78px;line-height:78px;text-align:center}.avatar{width:178px;height:78px;display:block}",""]),e.exports=t},448:function(e,t,n){"use strict";n.r(t);n(46),n(30),n(396),n(19),n(165);var r=n(8),o=(n(15),n(3)),c={data:function(){return{imageUrl:"",dialogImageUrl:"",dialogVisible:!1,defaultBanner:{state:0,src:"",title:"",subTitle:"",desc:""},form:{banners:[]}}},fetch:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$axios.$get("/api/admin/page/banner");case 2:(n=t.sent).success&&(e.form.banners=n.data.map((function(e){return e.state=1,e})),e.form.banners.push(e.defaultBanner));case 4:case"end":return t.stop()}}),t)})))()},methods:{bannerCreate:function(e){var t=this;return Object(o.a)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.$axios.$post("/api/admin/page/banner",{src:e.src,title:e.title,subTitle:e.subTitle,desc:e.desc});case 2:n.sent.success?(e.state=1,t.form.banners.push({state:0,src:"",title:"",subTitle:"",desc:""}),t.$message({showClose:!0,message:"".concat(t.$t("content.create")).concat(t.$t("content.success")),type:"success"})):t.$message({showClose:!0,message:"".concat(t.$t("content.create")).concat(t.$t("content.fail")),type:"error"});case 4:case"end":return n.stop()}}),n)})))()},bannerUpdate:function(e){var t=this;return Object(o.a)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.$axios.$post("/api/admin/page/banner/update",e);case 2:n.sent.success?(e.state=1,t.$message({showClose:!0,message:"".concat(t.$t("content.update")).concat(t.$t("content.success")),type:"success"})):t.$message({showClose:!0,message:"".concat(t.$t("content.update")).concat(t.$t("content.fail")),type:"error"});case 4:case"end":return n.stop()}}),n)})))()},bannerDelete:function(e){var t=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o,c,l,d,element;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.$axios.$post("/api/admin/page/banner/delete",{bannerId:e.bannerId});case 2:if(n.sent.success){for(o=0,c=Object.entries(t.form.banners);o<c.length;o++)l=Object(r.a)(c[o],2),d=l[0],element=l[1],e.bannerId===element.bannerId&&t.form.banners.splice(d,1);t.$message({showClose:!0,message:"".concat(t.$t("content.delete")).concat(t.$t("content.success")),type:"success"})}else t.$message({showClose:!0,message:"".concat(t.$t("content.delete")).concat(t.$t("content.fail")),type:"error"});case 4:case"end":return n.stop()}}),n)})))()},uploadSuccess:function(e,t){this.banners.push({src:e.data.src,url:e.data.src,name:t.name})},uploadRemove:function(e,t){for(var n=0,o=Object.entries(this.banners);n<o.length;n++){var c=Object(r.a)(o[n],2),l=c[0];c[1].name===e.name&&this.banners.splice(l,1)}},uploadPreview:function(e){this.dialogImageUrl=e.url,this.dialogVisible=!0},handleAvatarSuccess:function(e,t,n){console.log("handleAvatarSuccess",e,t,n),this.form.banners[e.data.index].src=e.data.src,console.log(this.form)}}},l=(n(425),n(427),n(14)),component=Object(l.a)(c,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"banner"},[n("el-form",{ref:"form",attrs:{model:e.form}},e._l(e.form.banners,(function(t,r){return n("el-form-item",{key:r},[n("el-row",{attrs:{gutter:20}},[n("el-col",{attrs:{span:3}},[t.state?n("el-button",{on:{click:function(n){return e.bannerUpdate(t)}}},[e._v(e._s(e.$t("content.update")))]):n("el-button",{on:{click:function(n){return e.bannerCreate(t)}}},[e._v(e._s(e.$t("content.create")))]),e._v(" "),n("el-button",{on:{click:function(n){return e.bannerDelete(t)}}},[e._v(e._s(e.$t("content.delete")))])],1),e._v(" "),n("el-col",{attrs:{span:5}},[n("el-upload",{staticClass:"avatar-uploader",attrs:{action:e.$config.origin+"/api/upload/images",data:{type:"banner",index:r},"show-file-list":!1,"on-success":e.handleAvatarSuccess}},[t.src?n("img",{staticClass:"avatar",attrs:{src:t.src}}):n("i",{staticClass:"el-icon-plus avatar-uploader-icon"}),e._v(" "),n("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("banner图片，请上传 大于1220X510 的图片")])])],1),e._v(" "),n("el-col",{attrs:{span:4}},[n("el-input",{attrs:{type:"textarea",placeholder:e.$t("form.placeholder",{msg:e.$t("content.title")})},model:{value:t.title,callback:function(n){e.$set(t,"title",n)},expression:"item.title"}})],1),e._v(" "),n("el-col",{attrs:{span:4}},[n("el-input",{attrs:{type:"textarea",placeholder:e.$t("form.placeholder",{msg:e.$t("content.subTitle")})},model:{value:t.subTitle,callback:function(n){e.$set(t,"subTitle",n)},expression:"item.subTitle"}})],1),e._v(" "),n("el-col",{attrs:{span:4}},[n("el-input",{attrs:{type:"textarea",placeholder:e.$t("form.placeholder",{msg:e.$t("content.desc")})},model:{value:t.desc,callback:function(n){e.$set(t,"desc",n)},expression:"item.desc"}})],1)],1)],1)})),1)],1)}),[],!1,null,"0d60f641",null);t.default=component.exports}}]);